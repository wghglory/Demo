<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script type="text/javascript">
        window.onload = function () {

            document.getElementById('btnLogin').onclick = function () {

                var loginId = document.getElementById('txtLoginId').value;
                var pwd = document.getElementById('txtLoginPwd').value;

                //发起异步请求验证登录
                //一、创建对象
                var xhr = null;
                if (XMLHttpRequest) {
                    xhr = new XMLHttpRequest();
                } else {
                    xhr = new ActiveXObject("Microsoft.XMLHttp");
                }
                //二、注册事件
                xhr.onreadystatechange = function () {
                    //.....服务器登录成功返回1，失败返回2
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        var spObj = document.getElementById('spMessage');
                        if (xhr.responseText == "1") {
                            //登录成功！
                            spObj.innerHTML = '登录成功！';
                        } else {
                            //登录失败！
                            spObj.innerHTML = '登录失败！';
                        }
                    }
                };
                //三、初始化
                xhr.open('post', 'ProcessLogin.ashx', true);

                //三.1、设置请求头
                xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");


                //四、发送
                xhr.send("loginId=" + loginId + "&pwd=" + pwd);

            };
        };
    </script>
</head>
<body>
    <table border="1" cellpadding="2" cellspacing="2">
        <tr>
            <td>
                用户名：
            </td>
            <td>
                <input type="text" id="txtLoginId" value="" />
            </td>
        </tr>
        <tr>
            <td>
                密码：
            </td>
            <td>
                <input type="password" id="txtLoginPwd" value="" />
            </td>
        </tr>
        <tr>
            <td>
            </td>
            <td>
                <input type="button" id="btnLogin" value="登录" />
            </td>
        </tr>
    </table>
    <span style="color: red; font: 30px 宋体;" id="spMessage"></span>
</body>
</html>
