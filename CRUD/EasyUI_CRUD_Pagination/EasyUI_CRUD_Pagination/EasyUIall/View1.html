<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Basic CRUD Application - jQuery EasyUI CRUD Demo</title>
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/color.css">
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/demo/demo.css">
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.6.min.js"></script>
    <script type="text/javascript" src="http://www.jeasyui.com/easyui/jquery.easyui.min.js"></script>
    <script src="../js/datapattern2.js"></script>
    <script type="text/javascript">
        $(function () {
            var url;
            $('#addnew').click(function () {
                $('#fm').form('clear');
                $('#dlg').dialog('open').dialog('setTitle', 'Add New');
                url = 'Add.ashx';
            });

            $('#edit').click(function () {
                var row = $('#dg').datagrid('getSelected');
                if (row) {
                    $('#dlg').dialog('open').dialog('setTitle', 'Edit');
                    $('#fm').form('load', row);
                    url = 'Edit.ashx?Id=' + row.Id;
                }
                else {
                    $.messager.alert('提醒消息', '请选中一行', 'warning');
                }
            });

            $('#remove').click(function () {
                var row = $('#dg').datagrid('getSelected');
                if (row) {
                    $.messager.confirm('Confirm', 'Are you sure you want to delete this record?', function (r) {
                        if (r) {
                            $.post('Delete.ashx', { id: row.Id }, function (result) {
                                if (result == 'ok') {
                                    $('#dg').datagrid('reload');    // reload the user data
                                } else {
                                    $.messager.show({    // show error message
                                        title: 'Error',
                                        msg: 'fail to delete'
                                    });
                                }
                            });
                        }
                    });
                }
                else {
                    $.messager.alert('提醒消息', '请选中一行', 'warning');
                }
            });

            $('#save').click(function () {
                $('#fm').form('submit', {
                    url: url,
                    onSubmit: function () {
                        return $(this).form('validate');
                    },
                    success: function (result) {
                        //var result = eval('(' + result + ')');
                        if (result != 'ok') {
                            $.messager.show({
                                title: 'Error',
                                msg: 'Please check your input' //result.errorMsg
                            });
                        } else {
                            $('#dlg').dialog('close');        // close the dialog
                            $('#dg').datagrid('reload');    // reload the user data
                            $('#fm').form('clear');
                        }
                    }
                });
            });

            $('#cancel').click(function () {
                $('#dlg').dialog('close');
                $('#fm').form('clear');
            });
           

        });


    </script>
    <style type="text/css">
        #fm {
            margin: 0;
            padding: 10px 30px;
        }

        .ftitle {
            font-size: 14px;
            font-weight: bold;
            padding: 5px 0;
            margin-bottom: 10px;
            border-bottom: 1px solid #ccc;
        }

        .fitem {
            margin-bottom: 5px;
        }

            .fitem label {
                display: inline-block;
                width: 80px;
            }

            .fitem input {
                width: 160px;
            }
    </style>
</head>
<body>
    <h2>Basic CRUD Application</h2>
    <!------------------------------------主表---------------------------------------------->
    <table id="dg" title="My Users" class="easyui-datagrid" style="width:800px;height:370px"
           url="View.ashx"
           toolbar="#toolbar" pagination="true"
           rownumbers="true" fitcolumns="true" singleselect="true">
        <thead>
            <tr>
                <th field="ProductName" width="50">ProductName</th>
                <th field="ProductCode" width="50">ProductCode</th>
                <th field="SellAmount" width="50">SellAmount</th>
                <th field="Purchaser" width="50">Purchaser</th>
                <th field="Salesperson" width="50">Salesperson</th>
                <th field="SellDate" width="50">SellDate</th>
                <th field="SellPrice" width="50">SellPrice</th>
            </tr>
        </thead>
    </table>
    <!------------------------------------增删改按钮---------------------------------------------->
    <div id="toolbar">
        <a id="addnew" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-add" plain="true">Add New</a>
        <a id="edit" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-edit" plain="true">Edit</a>
        <a id="remove" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-remove" plain="true">Remove</a>
    </div>
    <!------------------------------------模态对话框---------------------------------------------->
    <div id="dlg" class="easyui-dialog" style="width:400px;height:280px;padding:10px 20px"
         closed="true" buttons="#dlg-buttons">
        <div class="ftitle">Order Information</div>
        <form id="fm" method="post" novalidate>
            <div class="fitem">
                <label>ProductName:</label>
                <input name="ProductName" class="easyui-textbox" required="true">
            </div>
            <div class="fitem">
                <label>ProductCode:</label>
                <input name="ProductCode" class="easyui-textbox" required="true">
            </div>
            <div class="fitem">
                <label>SellAmount:</label>
                <input name="SellAmount" class="easyui-textbox">
            </div>
            <div class="fitem">
                <label>Purchaser:</label>
                <input name="Purchaser" class="easyui-textbox">  <!--validtype="email"-->
            </div>
            <div class="fitem">
                <label>Salesperson:</label>
                <input name="Salesperson" class="easyui-textbox">
            </div>
            <div class="fitem">
                <label>SellDate:</label>
                <input name="SellDate" class="easyui-textbox">
            </div>
            <div class="fitem">
                <label>SellPrice:</label>
                <input name="SellPrice" class="easyui-textbox">
            </div>
        </form>
    </div>
    <!-----------------------------模态对话框按钮：确认、取消------------------------------------->
    <div id="dlg-buttons">
        <a id="save" href="javascript:void(0)" class="easyui-linkbutton c6" iconcls="icon-ok" style="width:90px">Save</a>
        <a id="cancel" href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-cancel" style="width:90px">Cancel</a>
    </div>
</body>
</html>
